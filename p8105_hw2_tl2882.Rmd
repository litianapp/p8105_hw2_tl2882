---
title: "p8105_hw2_tl2882"
author: "Tian Li"
date: 2018-10-03
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

# Problem 1

```{r read_and_tidy_data}
data1 = read.csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>% 
  select(line, station_name, station_latitude, station_longitude, route1:route11,
         entry, vending, entrance_type, ada) %>% 
  mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE))
```

The variables the dataset contains are names of line, names of station, latitudes of station, longitudes of station, train of route1 to route11, entry allowed or not, with vending or not, type of entrance, ADA compliant or not.

Data cleaning steps so far include changing original variable names into reasonable names, selecting needed variables (columns), and converting the entry variable from character (YES vs NO) to a logical variable (TRUE vs FALSE).

The dimension of resulting dataset is (```r  dim(data1) ```) (the first number is the number of the rows, the second number is the number of the columns)

These data are not tidy because there are columns named route1 to route11.

## Problem 1.1

```{r Problem1_1}
data1_distinct = distinct(data1, line, station_name, .keep_all = TRUE)
nrow(data1_distinct)
```

There are 465 distinct stations.

## Problem 1.2

```{r Problem1_2}
nrow(filter(data1_distinct, ada == TRUE))
```

84 distinct stations are ADA compliant.

## Problem 1.3

```{r Problem1_3}
data1_withoutvending = filter(data1, vending == "NO")
sum(data1_withoutvending$entry)/length(data1_withoutvending$entry)
```

37.70492% of station entrances / exits without vending allow entrance.

## Reformat data
```{r Reformat_data}
data1_A_distinct = gather(data1, key = route, value = train, route1:route11) %>% 
  filter(train == "A") %>% 
  distinct(line, station_name, .keep_all = TRUE)
nrow(data1_A_distinct)
nrow(filter(data1_A_distinct, ada == TRUE))
```

60 distinct stations serve the A train.

Of the stations that serve the A train, 17 stations are ADA compliant.

# Problem 2

## Read and clean the Mr. Trash Wheel sheet:

```{r read_and_tidy_data2}
library(readxl)
data2 = read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx",
                 range = cell_cols("A:N"))  %>% 
  janitor::clean_names() %>% 
  filter(!is.na(dumpster), month != "Grand Total") %>% 
  mutate(sports_balls = as.integer(round(sports_balls)))
```

## Read and clean precipitation data for 2016 and 2017:

```{r read_and_tidy_precipitation_data}
prec_2016 = read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx",
                   sheet = "2016 Precipitation", range = "A2:B14")  %>% 
  mutate(year = "2016")

prec_2017 = read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx",
                       sheet = "2017 Precipitation", range = "A2:B10")  %>% 
  mutate(year = "2017")

data_prec = bind_rows(prec_2016, prec_2017) %>% 
  janitor::clean_names() %>%
  mutate(month = month.name[month])
```

